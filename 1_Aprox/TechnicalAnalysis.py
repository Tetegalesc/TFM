import pandas as pd
import numpy as np

import talib as ta

class TA():

    def __init__(self, df, timeperiods):
        
        self.df = df
        self.timeperiods = timeperiods

    #===================================================================================================================
    #===================================================================================================================
    #===================================================================================================================
    # ALL
    #===================================================================================================================
    #===================================================================================================================
    #===================================================================================================================
    
    def ALL(self):
        self.OverlapStudies()
        self.MomentumIndicators()

    #===================================================================================================================
    #===================================================================================================================
    # Overlap Studies
    #===================================================================================================================
    #===================================================================================================================

    def OverlapStudies(self):
        self.MA()

    #===================================================================================================================
    # Moving Averages
    #===================================================================================================================

    def MA(self):
        self.SMA()
        self.EMA()

    # SMA. Simple Moving Average
    def SMA(self):
        for period in self.timeperiods:
            self.df['SMA{}'.format(period)] = ta.SMA(self.df['close'], timeperiod=period)

    # EMA. Exponential Moving Average
    def EMA(self):
        for period in self.timeperiods:
            self.df['EMA{}'.format(period)] = ta.EMA(self.df['close'], timeperiod=period)

    #===================================================================================================================
    #===================================================================================================================
    # Momentum Indicators
    #===================================================================================================================
    #===================================================================================================================

    def MomentumIndicators(self):
        self.MACD()
        self.RSI()

    # MACD. Moving Average Convergence Divergence
    def MACD(self):
        self.df['MACD'], self.df['MACD_Signal'], self.df['MACD_Hist'] = ta.MACD(self.df['close'], fastperiod=12, slowperiod=26, signalperiod=9)

    # RSI. Relative Strength Index
    def RSI(self):
        self.df['RSI'] = ta.RSI(self.df['close'])